# gRPCとはなにか
2019年4月のWEB+DB

### gRPC
- gRPCを導入することで様々な言語で書かれたクライアントアプリケーションから、自動生成共通のインターフェースを介して、別のマシンのサーバアプリケーションへと通信手段を意識せずに接続できる
- Googleが自社内で使うために開発されたStubbyという汎用RPC技術を10年以上使ってきていた
- HTTP/2やQUICの登場により、Stubbyの持つ機能の多くが標準化されたため、gRPCとして作り直した

### gRPCの特徴
- Protocol Buffersによる強い型付けのインターフェース
  - 定義したメソッドの引数や戻り値の型、やりとりするデータ及びそのフィールドが一目瞭然
  - 様々な言語のコードを自動生成できる
- HTTP/2によるサービス間の柔軟な通信
  - 基本的な構造はHTTP/1.xと同じ
  - 特徴はストリーム
    - 同一のTCP接続においてクライアントとサーバ間で双方向にデータをやり取りできる仕組み
    - 単一のTCP接続の中で複数のストリームを生成し、リクエストとレスポンスを並列で処理できる
- 様々な言語およびプラットフォームで使用可能
  - WindowsでもMacでもLinuxでも、JavaでもGoでも動く

### gRPCの用途
- マイクロサービス間の通信
- モバイルアプリとサーバ間の通信
  - モバイルとサーバ間の通信効率化を期待できる
- ブラウザとサーバ間の通信
  - 2018年10月にgrpc-webが正式にリリースされた
  - 特別なプロキシ(デフォルトはenvoy)を使用して、バックエンドのgRPCサーバへの通信手段を意識せずに接続できる

### gRPCとRESTの比較
- 設計モデル
  - REST
    - リソース指向
  - gRPC
    - 通信相手に操作を要求する手法
    - メソッドやサービスを定義
- データ形式
  - REST: JSON
    - JSONと決まっているわけではないが、デファクトスタンダード
    - サーバとクライントの両方でJSONをパースする必要がある
  - gRPC: バイナリ
    - シームレスに通信可能
- 通信方式
  - REST: リクエスト/レスポンス
    - 1リクエスト/1レスポンス
  - gRPC: 様々なストリーミング
    - HTTP/2の機能を活かした双方向通信が可能
