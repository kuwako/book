# 最新TLS1.3徹底解剖
WEB+DB 110(2019)
1. Webの安心/安全を支えるTLS
2. 暗号技術の基礎
3. TLS1.3の通信を覗いてみよう
4. パフォーマンスを比較してみよう

# Webの安心安全を支えるTLS
## SSL/TLSの歴史
- SSLの誕生
    - SSL1.0は仕様のみ、2.0は脆弱性が発見される
    - 3.0は成功し、10年利用された。特に公開鍵基盤を利用できるようになったことが大きかった
- TLS1.0からTLS1.2まで
    - SSL3.0の仕様を引き継ぎ、標準化されたのがTLS1.0

## TLS1.3における改善点
- アルゴリズムの選別
    - TLS1.2では危殆化したとされる暗号アルゴリズムの多くが削除された
- 前方秘匿性の徹底
    - 世本暗号化の鍵に必要な情報を使い捨てにすることで、過去にさかのぼって暗号データを復元できないようにする
    - TLS1.3ではPFSが採用され、鍵のもととなる情報をセッションごとに廃棄するため、攻撃者は鍵やそのもととなる情報を後から入手するのは困難になる
- プロトコルの改良
  - TLS1.2と違いHnadshakeで往復する回数が半分で済む(2-RTT -> 1-RTT)
  - セッション再開時にはPSK(pre-shared key/事前鍵交換)で0-RTTが実現できる

## QUICとHTTP/3
- Googleは早くからHTTP/2の問題点を指摘し、自社サービス向けにQUICというプロトコルを自社開発していた
- QUICはHTTP/3と呼ばれることが決まった(2019リリース目標)
- QUICはTLS1.3を前提としている

# 暗号技術の基礎
## 共通鍵暗号
- XOR演算がわかりやすい
- ブロック暗号
  - データをブロックに分け、換字処理や転置処理を繰り返し暗号化する方式
  - CBCというブロック連結方式が代表的でTLS1.2までは主要な暗号利用モードとして使われていたが、暗号の開始部と終了部に弱点がある
- ストリーム暗号
  - データのストリームにあ合わせて乱数を生成しビットやバイト単位で演算しながら暗号化する方式
  - 暗号化結果との依存関係ではなく、鍵から生成した乱数を使って演算する点が異なる
  - BEAST攻撃への効果的な対策とされた

## ハッシュ関数
- 1方向性

## 公開鍵暗号
- 1方向性関数の性質を利用し、鍵を公開鍵と秘密鍵に分ける
- RSAが有名だが、問題点が多く、TLS1.3では除外された
- TLS1.3ではDHとECDHしか使わない
  - DH: 自分の秘密鍵と一緒にべき乗と剰余演算で計算すると同じ結果が得られる特性
  - ECDH: 楕円曲線上の離散対数問題における一方向性を利用

## デジタル署名
- 公開鍵暗号は画期的だが、中間者攻撃を防げない
- SSL/TLSでは公開鍵を「証明書」形式で配布し、その証明書にデジタル署名をつけることで公開鍵の完全性と真正性を保証

# TLS1.3の通信を覗く
